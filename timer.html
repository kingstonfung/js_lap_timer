<!DOCTYPE html>
<html>
  <head>
    <title>Redux JS Lap Timer</title>
    <script type="text/javascript" src="redux.min.js"></script>
  </head>
  <body>
    <div class="timerText"></div>
    <button class="startTimerButton">Start Timer</button>
    <button class="stopTimerButton">Stop Timer</button>
    <button class="lapTimerButton">Lap</button>
    <button class="resetButton">RESET EVERYTHING</button>
    <script type="text/javascript" src="timer.js"></script>
    <script type="text/javascript">
      ((doc, ls, redux) => {
        /* global Kingular:true */
        const CLICK_EVENT = 'click';
        const startBtn = doc.getElementsByClassName('startTimerButton')[0];
        const stopBtn = doc.getElementsByClassName('stopTimerButton')[0];
        const lapBtn = doc.getElementsByClassName('lapTimerButton')[0];
        const resetBtn = doc.getElementsByClassName('resetButton')[0];
        const timerDisplayElement = doc.getElementsByClassName('timerText')[0];
        let timerTick;
        let timer;

        stopBtn.addEventListener(CLICK_EVENT, () => {
          timer.stopTimer();
        });

        lapBtn.addEventListener(CLICK_EVENT, () => {
          timer.lapTimer();
        });

        startBtn.addEventListener(CLICK_EVENT, () => {
          timer.startTimer();
        });

        resetBtn.addEventListener(CLICK_EVENT, () => {
          timer.resetTimer();
        });


        // Function declartion, hoisted up to the top upon exectuion.
        timerTick = (timerState) => {
          const laps = timerState.laps;
          let displayStr = '0';
          if (laps.length) {
            displayStr = laps.map(time => time);
          }
          timerDisplayElement.innerHTML = displayStr;
        }

        timer = Kingular.clientTimer(ls, redux, timerTick);
      })(document, window.localStorage, Redux); // IIFE
    </script>
  </body>
</html>
